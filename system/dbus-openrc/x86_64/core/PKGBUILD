# Maintainer: artoo <artoo@artixlinux.org>

pkgname=dbus-openrc
pkgver=20200911
pkgrel=1
pkgdesc="OpenRC dbus init script"
arch=('any')
url="https://gitea.artixlinux.org/artixlinux/packages-openrc"
license=('GPL2')
depends=('dbus' 'openrc')
provides=('init-dbus')
conflicts=('init-dbus')
source=('dbus.initd'
        'dbus-reload.hook'
        '80-dbus')
sha256sums=('9964aa935b4a7d64f5970bcfcd561b06013a85ae2712444bc4c5f644364dab3b'
            '517cb12a30f84ba9580532d5485ce219ad96668480db99fcd4954c7017a0ea47'
            '6d637acae40368db9e7c005b2e53483882014caef281fe9e801633ba7cc3b7dd')

package() {
    install -Dm755 "${srcdir}"/dbus.initd "${pkgdir}"/etc/init.d/dbus

    install -d "${pkgdir}"/etc/runlevels/default
    ln -sf /etc/init.d/dbus "${pkgdir}"/etc/runlevels/default/dbus

    install -Dt "${pkgdir}"/usr/share/libalpm/hooks -m644 *.hook

    install -Dm755 "${srcdir}"/80-dbus "${pkgdir}"/etc/X11/xinit/xinitrc.d/80-dbus.sh
}
