# Maintainer: Cory Sanin <corysanin@artixlinux.org>
# Contributor: Carl Smedstad <carsme@archlinux.org>

pkgname=cava
pkgver=0.10.6
pkgrel=1
pkgdesc='Console-based Audio Visualizer with support for multiple backends'
arch=('x86_64')
url='https://github.com/karlstav/cava'
license=('MIT')
# Compile with support for (and depend on) all input/output backends for
# simplicity's sake. One could possibly split this into one package per
# backend, but let's start with this.
depends=(
  'fftw'
  'glibc'
  'iniparser'
  # Input backends
  'alsa-lib'
  'jack'
  'libpipewire'
  'libpulse'
  'portaudio'
  'sndio'
  # Output backends
  'ncurses'
  'sdl2'
)
source=("$url/archive/$pkgver/$pkgname-$pkgver.tar.gz")
sha512sums=('597bf2d7f5a18d1643ca989c2f0b08bad922d7fe84e33513c6842ac820afa8811c8293f5e796e0b40a59c7e34a0e8b653f15d2253fc424db005c166975c5c50a')

prepare() {
  cd $pkgname-$pkgver
  echo "$pkgver" > version
  autoreconf -vif
}

build() {
  cd $pkgname-$pkgver
  ./configure --prefix=/usr
  make
}

package() {
  cd $pkgname-$pkgver
  make DESTDIR="$pkgdir" install
  install -vDm644 -t "$pkgdir/usr/share/doc/$pkgname" README.md
  install -vDm644 -t "$pkgdir/usr/share/licenses/$pkgname" LICENSE
}
