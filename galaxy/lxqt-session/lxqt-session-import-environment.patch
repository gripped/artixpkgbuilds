From 8d4a43f28d876e36c7fa8f180b68ec9705990f04 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Ball=C3=B3=20Gy=C3=B6rgy?= <ballogyor@gmail.com>
Date: Thu, 9 Oct 2025 22:31:59 +0200
Subject: [PATCH] Set XDG_CURRENT_DESKTOP for new units started by user service
 manager

This fixes the problem that XDG Desktop Portal does not use the LXQt backend under LXQt session.
---
 startlxqt.in | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/startlxqt.in b/startlxqt.in
index 260c34fc..49c69bca 100755
--- a/startlxqt.in
+++ b/startlxqt.in
@@ -64,5 +64,10 @@ export XDG_MENU_PREFIX="lxqt-"
 
 export XDG_CURRENT_DESKTOP="LXQt"
 
+# set environment variables for new units started by user service manager
+if command -v systemctl >/dev/null; then
+    systemctl --user import-environment XDG_CURRENT_DESKTOP
+fi
+
 # Start the LXQt session
 exec lxqt-session
