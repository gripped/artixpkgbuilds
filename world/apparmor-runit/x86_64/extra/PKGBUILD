# Maintainer: Muhammad Herdiansyah <koni@artixlinux.org>

pkgname=apparmor-runit
pkgver=20210129
pkgrel=2
pkgdesc="runit stage1 script for AppArmor"
arch=('any')
url="https://artixlinux.org"
license=('BSD')
groups=('runit-world')
provides=('init-apparmor')
depends=('apparmor' 'runit')
conflicts=('init-apparmor')
backup=('etc/rc/apparmor.conf')
install=apparmor-runit.install
source=('apparmor' 'apparmor.conf')
sha256sums=('9618cb1f13969791ebf83e66f30c28b132493ffa8cf04058b46d05e26e6d2c05'
            '2d706f8c6b5bbb35087890f6ce3f4cdb94854b893050eb215274293f094b682a')

package() {
    install -Dm755 "${srcdir}/apparmor" "${pkgdir}/usr/lib/rc/sv.d/apparmor"
    install -Dm644 "${srcdir}/apparmor.conf" "${pkgdir}/etc/rc/apparmor.conf"

    install -d ${pkgdir}/etc/rc/sysinit
    ln -sf /usr/lib/rc/sv.d/apparmor ${pkgdir}/etc/rc/sysinit/96-apparmor
}
