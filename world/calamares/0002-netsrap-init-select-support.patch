From 25c7bf0aebdd513db062718d21e3124cdc111fee Mon Sep 17 00:00:00 2001
From: artoo <artoo@artixlinux.org>
Date: Tue, 26 Dec 2023 00:51:02 +0100
Subject: [PATCH 1/1] add init select support

---
 src/modules/netstrap/main.py       | 9 +++++++++
 src/modules/netstrap/netstrap.conf | 9 ++++-----
 2 files changed, 13 insertions(+), 5 deletions(-)

diff --git a/src/modules/netstrap/main.py b/src/modules/netstrap/main.py
index 607244f9f..7d35dbee6 100644
--- a/src/modules/netstrap/main.py
+++ b/src/modules/netstrap/main.py
@@ -495,6 +495,15 @@ def run():
 
     operations = libcalamares.job.configuration.get("operations", [])
 
+    if libcalamares.job.configuration.get("base_select"):
+        base_select = libcalamares.job.configuration.get("base_select", None)
+
+    if libcalamares.globalstorage.value("packagechooser_packagechooserq"):
+        init_select = libcalamares.globalstorage.value("packagechooser_packagechooserq")
+        init_pkg = base_select + '-' + init_select
+        libcalamares.utils.debug("Package added: {!s}".format(init_pkg))
+        operations[0]["install"].append(init_pkg)
+
     mode_packages = None
     total_packages = 0
     completed_packages = 0
diff --git a/src/modules/netstrap/netstrap.conf b/src/modules/netstrap/netstrap.conf
index 19628ec00..c97ee07bc 100644
--- a/src/modules/netstrap/netstrap.conf
+++ b/src/modules/netstrap/netstrap.conf
@@ -57,11 +57,10 @@ pacman:
     keyrings:
       - artix
 
+# the artix base package allows selection of the init system tied to elogind
+# this option is artix specific
+# base_select: elogind
+
 operations:
   - install:
     - base
-    - elogind-openrc
-    - linux
-    - nano
-    - grub
-    - sudo
-- 
2.43.0

