From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Lars Windolf <lars.windolf@gmx.de>
Date: Mon, 22 Sep 2025 17:56:27 +0200
Subject: [PATCH] Backport fixes from #1459

---
 plugins/download-manager.py  | 1 -
 plugins/gnome-keyring.py     | 1 -
 plugins/trayicon.py          | 1 -
 src/plugins/plugins_engine.c | 3 +--
 4 files changed, 1 insertion(+), 5 deletions(-)

diff --git a/plugins/download-manager.py b/plugins/download-manager.py
index 22e1f0850ef2..6e5b76246841 100644
--- a/plugins/download-manager.py
+++ b/plugins/download-manager.py
@@ -24,7 +24,6 @@ import os
 import time
 
 gi.require_version('Gtk', '3.0')
-gi.require_version('Liferea', '3.0')
 
 from gi.repository import GObject, GLib, Gtk, Gio, Liferea, Pango
 from urllib.parse import urlparse
diff --git a/plugins/gnome-keyring.py b/plugins/gnome-keyring.py
index 754fdaa47b5f..fdd3484f5cc5 100644
--- a/plugins/gnome-keyring.py
+++ b/plugins/gnome-keyring.py
@@ -19,7 +19,6 @@ along with this program.  If not, see <https://www.gnu.org/licenses/>.
 """
 
 import gi
-gi.require_version('Liferea', '3.0')
 gi.require_version('Secret', '1')
 from gi.repository import GObject, Liferea, Secret
 
diff --git a/plugins/trayicon.py b/plugins/trayicon.py
index d89a237afbf2..03de6bd2eafa 100644
--- a/plugins/trayicon.py
+++ b/plugins/trayicon.py
@@ -24,7 +24,6 @@ from pathlib import Path
 from collections import namedtuple
 import cairo
 import gi
-gi.require_version('Liferea', '3.0')
 from gi.repository import Gio, GLib, GObject, Gtk, Liferea
 from gi.repository import Gdk, GdkPixbuf
 
diff --git a/src/plugins/plugins_engine.c b/src/plugins/plugins_engine.c
index 20cc0dec4508..9a5a1358d617 100644
--- a/src/plugins/plugins_engine.c
+++ b/src/plugins/plugins_engine.c
@@ -112,8 +112,7 @@ liferea_plugins_engine_init (LifereaPluginsEngine *plugins)
 		error = NULL;
 	}
 #else
-	g_autoptr(GIRepository) repo = gi_repository_new ();
-	if (!gi_repository_require_private (repo,
+	if (!gi_repository_require_private (gi_repository_dup_default (),
 		typelib_dir, "Liferea", "3.0", 0, &error)) {
 		g_warning ("Could not load Liferea repository: %s", error->message);
 		g_error_free (error);
