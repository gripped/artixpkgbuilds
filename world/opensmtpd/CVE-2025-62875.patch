OpenBSD 7.8 errata 005, October 31, 2025:

smtpd(8) can die if a malformed imsg is sent on the local socket.
CVE-2025-62875

diff --git a/usr.sbin/smtpd/mproc.c b/usr.sbin/smtpd/mproc.c
index e78cff00..44b03b8a 100644
--- a/usr.sbin/smtpd/mproc.c
+++ b/usr.sbin/smtpd/mproc.c
@@ -154,6 +154,14 @@ mproc_dispatch(int fd, short event, void *arg)
 
 		switch (n) {
 		case -1:
+			if (smtpd_process == PROC_CONTROL &&
+			    p->proc == PROC_CLIENT) {
+				log_warnx("warn: client sent invalid imsg "
+				    "over control socket");
+				p->handler(p, NULL);
+				return;
+			}
+
 			log_warn("warn: %s -> %s: imsgbuf_read",
 			    proc_name(smtpd_process),  p->name);
 			fatal("exiting");
